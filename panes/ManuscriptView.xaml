<UserControl x:Class="WordForge.Panes.ManuscriptView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:avalonEdit="http://icsharpcode.net/sharpdevelop/avalonedit"
             xmlns:local="clr-namespace:WordForge.Panes"
             xmlns:models="clr-namespace:WordForge.models"
             mc:Ignorable="d"
             d:DesignHeight="500" d:DesignWidth="800">

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="15*" />
            <ColumnDefinition Width="60*" />
            <ColumnDefinition Width="25*" />
        </Grid.ColumnDefinitions>

        <!-- Left Pane: Chapter/Scene Tree -->
        <Border Grid.Column="0" Background="#F0F0F0" Padding="10">
            <TreeView ItemsSource="{Binding ChapterList}"
                      SelectedItemChanged="TreeView_SelectedItemChanged"
                      FontSize="13">
                <TreeView.Resources>
                    <HierarchicalDataTemplate DataType="{x:Type models:ChapterNode}" ItemsSource="{Binding Scenes}">
                        <TextBlock Text="{Binding Title}" FontWeight="Bold">
                            <TextBlock.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="Rename" Command="{Binding DataContext.RenameChapterCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" />
                                    <MenuItem Header="Delete" Command="{Binding DataContext.DeleteChapterCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" />
                                    <Separator />
                                    <MenuItem Header="Insert Chapter Above" Command="{Binding DataContext.InsertChapterAboveCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" />
                                    <MenuItem Header="Insert Chapter Below" Command="{Binding DataContext.InsertChapterBelowCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" />
                                </ContextMenu>
                            </TextBlock.ContextMenu>
                        </TextBlock>
                    </HierarchicalDataTemplate>
                    <DataTemplate DataType="{x:Type models:SceneNode}">
                        <TextBlock Text="{Binding Title}">
                            <TextBlock.ContextMenu>
                                <ContextMenu>
                                    <MenuItem Header="Rename" Command="{Binding DataContext.RenameSceneCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" />
                                    <MenuItem Header="Delete" Command="{Binding DataContext.DeleteSceneCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" />
                                    <Separator />
                                    <MenuItem Header="Insert Scene Above" Command="{Binding DataContext.InsertSceneAboveCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" />
                                    <MenuItem Header="Insert Scene Below" Command="{Binding DataContext.InsertSceneBelowCommand, RelativeSource={RelativeSource AncestorType=UserControl}}" CommandParameter="{Binding}" />
                                </ContextMenu>
                            </TextBlock.ContextMenu>
                        </TextBlock>
                    </DataTemplate>
                </TreeView.Resources>
            </TreeView>
        </Border>

        <!-- Center Pane: AvalonEdit Editor -->
        <Border Grid.Column="1" BorderThickness="1,0" BorderBrush="#DDD" Padding="10">
            <avalonEdit:TextEditor Name="Editor"
                                   FontFamily="Consolas"
                                   FontSize="14"
                                   ShowLineNumbers="False"
                                   SyntaxHighlighting="None" />
        </Border>

        <!-- Right Pane: Ad Panel -->
        <Border Grid.Column="2" Background="#F8F8F8" Padding="10">
            <StackPanel>
                <TextBlock Text="Promoted Content" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>
                <TextBlock Margin="0,10">• My Books on Amazon</TextBlock>
                <TextBlock Margin="0,10">• Goodreads Profile</TextBlock>
                <TextBlock Margin="0,10">• Author Website</TextBlock>
            </StackPanel>
        </Border>
    </Grid>
</UserControl>
